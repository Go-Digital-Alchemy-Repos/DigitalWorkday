You are continuing development on my existing single-codebase React + Express app.
This is PHASE 2B (SAFE): add tenant scoping for TIME TRACKING + REPORTS + ATTACHMENTS METADATA behind the same safety switch.
DO NOT rewrite the app. Implement ONLY the changes described below.

===============================================================================
SAFETY SWITCH (MANDATORY)
===============================================================================
Reuse TENANCY_ENFORCEMENT = off|soft|strict exactly as implemented in Phase 2A.

- soft: prefer scoped queries, fallback with warning headers/logs when legacy rows exist
- strict: enforce tenantId in all queries (no fallback)
- off: current behavior

IMPORTANT:
- Reports must never aggregate across tenants in strict mode.
- In soft mode, if fallback occurs, add X-Tenancy-Warn.

===============================================================================
SCOPE (ONLY)
===============================================================================
1) time_entries CRUD + selectors used in time tracking
2) active timers
3) reports endpoints
4) attachment metadata routes (if exist)
5) realtime event safety (tenant-safe emits)

===============================================================================
TIME ENTRIES
===============================================================================
- strict: id queries must include tenantId; list must filter by tenantId
- soft: scoped first; fallback unscoped with warnings if needed
- create: always set tenantId=effectiveTenantId

Validate referenced client/project/task belong to tenant (strict enforce, soft warn).

===============================================================================
ACTIVE TIMERS
===============================================================================
- scope by tenantId in all timer operations
- soft fallback with warning where legacy data exists
- ensure “one timer per user” includes tenantId

===============================================================================
REPORTS
===============================================================================
- strict: all report queries include tenantId=:effectiveTenantId; no fallback
- soft: if legacy null tenantId rows exist, either:
  - exclude them and warn, OR
  - fallback only if explicitly safe (prefer exclude to avoid leakage)
Implement as:
- strict: require tenantId
- soft: tenant-filtered only; if missing tenantId rows affect totals, warn via X-Tenancy-Warn and admin-visible banner.

===============================================================================
ATTACHMENTS METADATA
===============================================================================
If attachments table exists:
- strict: filter by tenantId
- soft: scoped first; fallback with warn
Do NOT migrate S3 keys in Phase 2B.

===============================================================================
REALTIME SAFETY
===============================================================================
- Ensure events never broadcast across tenants
- If you have rooms, include tenant scoping in room naming or ensure that record ids are tenant-contained
- All emits via /server/src/realtime/events.ts

===============================================================================
TESTS (MANDATORY)
===============================================================================
Add tests for:
- time entries isolation (soft warns, strict denies)
- timers isolation
- reports isolation (strict never aggregates cross-tenant)
- attachments isolation (if applicable)

Add scripts:
- test:tenancy:soft
- test:tenancy:strict

===============================================================================
ACCEPTANCE CRITERIA
===============================================================================
1) With TENANCY_ENFORCEMENT=soft, app works and logs/warns on legacy or cross-tenant situations.
2) With TENANCY_ENFORCEMENT=strict, time entries/timers/reports/attachments cannot leak cross-tenant.
3) Reports in strict mode never include data outside tenant; if tenantId missing, it is excluded.
4) No endpoint paths changed; time tracking workflows still work.

===============================================================================
OUTPUT REQUIRED
===============================================================================
- Summary of changes
- How soft mode warnings are surfaced
- Tests added + how to run
- Instructions to safely flip strict on Railway
